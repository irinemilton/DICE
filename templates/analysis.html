{% extends "base.html" %}
{% block content %}

<div class="analysis-container">
    <div class="hero-section">
        <h1>Analysis Results</h1>
        <p class="subtitle">Powered by Advanced AI</p>
    </div>

    <div class="result-card">
        <div class="result-badge {{ result.label|lower() }}">
            <span class="result-icon">{{ 'âœ“' if result.label == 'REAL' else 'Ã—' }}</span>
            {{ result.label }}
        </div>

        <div class="confidence-section">
            <div class="chart-wrapper">
                <canvas id="confidenceChart"></canvas>
                <div class="confidence-value">
                    <span class="value">{{ (result.confidence*100)|round(2) }}%</span>
                    <span class="label">Confidence</span>
                </div>
            </div>
        </div>

        <div class="explanation-section">
            <h2>Analysis Details</h2>
            <p>{{ result.explanation }}</p>
        </div>

        {% if result.source %}
        <div class="sources-section">
            <h2>Verified Sources</h2>
            <div class="sources-grid">
                {% for src in result.source.split(',') %}
                <div class="source-item">
                    <span class="source-icon">ðŸ“„</span>
                    <span class="source-text">{{ src }}</span>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <form method="GET" action="{{ url_for('quiz') }}" class="quiz-form">
            <input type="hidden" name="text" value="{{ result.input_text }}">
            <button type="submit" class="btn-submit">
                Take the Quiz
                <span class="btn-arrow">â†’</span>
            </button>
        </form>
    </div>
</div>

<style>
:root {
    --background: #f5f5f7;
    --text-primary: #1d1d1f;
    --text-secondary: #86868b;
    --accent: #0071e3;
    --success: #28cd41;
    --error: #ff3b30;
    --card-bg: #ffffff;
}

.analysis-container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 4rem 2rem;
    background: var(--background);
    min-height: 100vh;
}

.hero-section {
    text-align: center;
    margin-bottom: 3rem;
}

.hero-section h1 {
    font-size: 3.5rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.subtitle {
    font-size: 1.5rem;
    color: var(--text-secondary);
}

.result-card {
    background: var(--card-bg);
    border-radius: 20px;
    padding: 2rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
}

.result-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    border-radius: 20px;
    font-weight: 600;
    margin-bottom: 2rem;
}

.result-badge.real {
    background: rgba(40, 205, 65, 0.1);
    color: var(--success);
}

.result-badge.fake {
    background: rgba(255, 59, 48, 0.1);
    color: var(--error);
}

.confidence-section {
    max-width: 300px;
    margin: 2rem auto;
    position: relative;
}

.confidence-value {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
}

.confidence-value .value {
    display: block;
    font-size: 2rem;
    font-weight: 600;
    color: var(--text-primary);
}

.confidence-value .label {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.explanation-section, .sources-section {
    margin: 2rem 0;
}

h2 {
    font-size: 1.5rem;
    color: var(--text-primary);
    margin-bottom: 1rem;
}

.sources-grid {
    display: grid;
    gap: 1rem;
}

.source-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: var(--background);
    border-radius: 12px;
}

.btn-submit {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    width: 100%;
    padding: 1rem;
    background: var(--accent);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 1.1rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
}

.btn-submit:hover {
    background: #0077ed;
    transform: translateY(-2px);
}

.btn-arrow {
    transition: transform 0.3s ease;
}

.btn-submit:hover .btn-arrow {
    transform: translateX(5px);
}

@media (max-width: 768px) {
    .hero-section h1 {
        font-size: 2.5rem;
    }
    
    .subtitle {
        font-size: 1.25rem;
    }
    
    .result-card {
        padding: 1.5rem;
    }
}
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('confidenceChart').getContext('2d');
const data = {
    labels: ['Confidence', 'Remaining'],
    datasets: [{
        data: [{{ (result.confidence*100)|round(2) }}, {{ 100-(result.confidence*100)|round(2) }}],
        backgroundColor: ['#0071e3', '#f5f5f7'],
        borderWidth: 0,
    }]
};
new Chart(ctx, {
    type: 'doughnut',
    data: data,
    options: {
        cutout: '75%',
        plugins: {
            legend: {
                display: false
            }
        },
        animation: {
            animateScale: true,
            animateRotate: true
        }
    }
});
</script>

{% endblock %}
